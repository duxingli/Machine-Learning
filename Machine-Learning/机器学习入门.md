![1647567805038](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647567805038.png)

# 一 概述

## 1 什么是机器学习

![1626687691766](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626687691766.png)

![1626687727314](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626687727314.png)

![1626687758406](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626687758406.png)

![1626687829877](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626687829877.png)

![1626687917536](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626687917536.png)

![1626687970614](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626687970614.png)

![1626688050925](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626688050925.png)

![1626688169333](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626688169333.png)



## 2 课程涵盖的内容和理念

传统搜索算法!!!

![1626688448823](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626688448823.png)

![1626688478775](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626688478775.png)

逻辑回归  决策树 随机森林 神经网络

![1626688629141](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626688629141.png)

![1626688681600](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626688681600.png)

![1626688740736](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626688740736.png)



## 3 课程技术栈

![1626687254642](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626687254642.png)

![1626687275789](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626687275789.png)



![1626687317638](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626687317638.png)

![1626687338204](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626687338204.png)

![1626687398597](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626687398597.png)

![1626687463741](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626687463741.png)





# 二 机器学习的数据

## 1 数据

![1626688847584](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626688847584.png)

![1626688864948](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626688864948.png)



![1626689467267](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626689467267.png)



| 名词 | 表示 |
| :--: | :--: |
|  行  | 样本 |
|  列  | 特征 |
| 大写 | 矩阵 |
| 小写 | 向量 |

**多用列向量**

![1626689770298](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626689770298.png)

![1626689922858](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626689922858.png)

![1626690028265](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626690028265.png)



## 2 机器学习的主要任务（解决问题）

### 分类任务

![1626690208786](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626690208786.png)

![1626690219340](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626690219340.png)

![1626690351240](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626690351240.png)

![1626690399899](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626690399899.png)

![1626690540651](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626690540651.png)

![1626690557892](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626690557892.png)

![1626690569115](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626690569115.png)

![1626690648304](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626690648304.png)

![1626690669213](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626690669213.png)



![1626690749374](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626690749374.png)

价格（标签列）不是类别--->回归任务

### 回归任务

![1626690857397](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626690857397.png)

![1626690881401](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626690881401.png)

![1626690895006](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626690895006.png)

![1626691026639](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626691026639.png)



## 3 监督、非监督、半监督学习、增强学习（算法）

### 监督学习

主要处理 分类、回归 任务

这个课程中学习的大部分算法，属于监督学习算法：

+ k近邻
+ 线性回归和多项式回归
+ 逻辑回归
+ SVM
+ 决策树和随机森林

![1626691301540](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626691301540.png)

![1626691310754](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626691310754.png)

![1626691447002](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626691447002.png)

### 非监督学习

![1626691671744](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626691671744.png)

![1626691710657](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626691710657.png)



![1626691804596](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626691804596.png)

![1626692420879](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626692420879.png)

![1626692389519](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626692389519.png)

### 半监督学习

![1626692518706](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626692518706.png)

### 增强学习（阿法狗）

![1626692565926](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626692565926.png)

![1626692643368](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626692643368.png)

## 4 批量、在线、参数、非参数学习

![1626692705127](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626692705127.png)

### 批量学习(离线)

主要：

![1626743115873](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626743115873.png)

![1626743215989](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626743215989.png)





### 在线学习

![1626743251456](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626743251456.png)

![1626743316124](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626743316124.png)



![1626743487893](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626743487893.png)

### 参数学习

利用统计知识建模

![1626743513081](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626743513081.png)

![1626743525731](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626743525731.png)



### 非参数学习

不建模

![1626743583741](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626743583741.png)

## 5 哲学思考

![1626743754873](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626743754873.png)





![1626743791605](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626743791605.png)

![1626743804743](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626743804743.png)

（没有数据）

![1626743876412](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626743876412.png)

![1626743915489](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626743915489.png)

![1626743974359](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626743974359.png)

![1626743984663](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626743984663.png)

![1626744010244](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626744010244.png)

机器伦理学

## 6 环境搭建

![1626744087303](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626744087303.png)

![1626744101737](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626744101737.png)

![1626744147887](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626744147887.png)

包

![1626744187697](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626744187697.png)

![1626744223934](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626744223934.png)



# 三 Jupyter Notebook、numpy

## 1 Jupyter Notebook基础

文件夹

![1626744270608](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626744270608.png)

```python
"""
  App running at:
  - Local:   http://localhost:8081/
  - Network: http://192.168.2.41:8081/

  Note that the development build is not optimized.
  To create a production build, run npm run build.
""" 
#github.com/liuyubobobo/Play-with-Machine-Learning-Algorithms
import numpy  #处理矩阵
import matplotlib #格式化矩阵
import sklearn #机器学习的一些函数
import pandas #高级的数据表格管理

print("ML")

  cell ->run cell运行代码
  insert -> insert cells below
  ctrl+d删除内容
  shift+enter 运行并选中下一行
  ctrl+a输入下一行
  kernel->
	Restart & Run All 执行顺序（会报错没有顺序执行的变量）
	Run AllBelow(运行选中以下的所有格子)
```

![1626749684008](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1626749684008.png)

快捷键

shift + enter

ctrl + enter

## 2 Jupyter Noteboo中的魔法命令



## 3 Numpy数据基础



## 4 创建Numpy数据和矩阵



## 5 Numpy数组和矩阵的基本操作



## 6 Numpy数组和矩阵的合并与分割



## 7 Numpy中的矩阵运算



## 8 Numpy中的聚合运算



## 9 Numpy中的arg运算



## 10 Numpy中的比较和Fancy lindexing



## 11 Matplotlib数据可视化基础



## 12 数据加载和简单的数据搜索



# 四 KNN(要归一化)

## 1 K近邻算法

![1627450601666](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1627450678054.png)

红：良性肿瘤

蓝：恶性肿瘤

绿：新数据

![1627450745553](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1627450745553.png)

假设k

![1627450787957](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1627450787957.png)

![1627450816434](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1627450816434.png)

最近三个点：蓝：红 = 3：0

![1627450879573](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1627450879573.png)

![1627454057476](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1627454057476.png)

![1627454076949](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1627454076949.png)





## 2 scikit-learn机器学习算法封装

![1627467920982](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1627467920982.png)

![1627468000657](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1627468000657.png)

![1627468030035](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1627468030035.png)



## 3 训练数据集

![1630328506299](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630328506299.png)

![1630328616290](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630328616290.png)

![1630328627431](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630328627431.png)

训练数据与测试数据

## 4 分类准确度

![1630331070184](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630331070184.png)



## 5 超参数

![1630339114089](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630339114089.png)

![1630339234195](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630339234195.png)

![1630339469950](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630339469950.png)

考虑权重  距离->倒数

![1630339506837](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630339506837.png)

![1630339749175](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630339749175.png)

![1630339764523](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630339764523.png)

用于网格：绝对值距离

![1630339824951](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630339824951.png)



![1630339866193](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630339866193.png)

默认p=2，欧拉距离

## 6 网络搜索与K近邻算法中更多超参数

![1630412229066](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630412229066.png)

可以自己封装函数

## 7 数据归一化

![1630412420407](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630412420407.png)

![1630412478584](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630412478584.png)

![1630412543505](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630412543505.png)

![1630412625050](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630412625050.png)

![1630412685825](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630412685825.png)

除非边界非常清晰，一般都使用均值方差归一化



## 8 Scikit-learn中的Scaler

![1630414365669](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630414365669.png)

![1630414505511](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630414505511.png)

要使用同一个方差和均值-->对测试数据进行归一化

![1630414567255](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630414567255.png)

![1630414670728](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630414670728.png)

![1630414685761](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630414685761.png)

![1630418596722](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630418596722.png)

可以自己封装





## 9 更多有关K近邻算法的思考

![1630418654029](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630418654029.png)

![1630418710065](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630418710065.png)

![1630418760361](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630418760361.png)

![1630418871214](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630418871214.png)

![1630418903551](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630418903551.png)

![1630418979962](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630418979962.png)

![1630419109326](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630419109326.png)



# 五 线性回归

## 1 简单线性回归

![1630456642864](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630456642864.png)

多项式回归、逻辑回归、SVM的基础

![1630456786189](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630456786189.png)

![1630456812544](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630456812544.png)

分类是两个特征，回归是一个特征，一个输出标记

![1630456918959](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630456918959.png)

![1630456995066](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630456995066.png)

![1630457066360](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630457066360.png)

![1630457108282](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630457108282.png)

![1630457173924](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630457173924.png)

![1630457249919](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630457249919.png)

![1630457307012](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630457307012.png)





## 2 最小二乘法

![1630457396346](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630457396346.png)

![1630457470075](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630457470075.png)

![1630457531964](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630457531964.png)

![1630457592147](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630457592147.png)

![1630457710538](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630457710538.png)

x拔，y拔看作常数，提到求和号里面

![1630458019186](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630458019186.png)



## 3 简单线性回归的实现



## 4 衡量线性回归的指标

![1630458741866](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630458741866.png)

![1630458845911](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630458845911.png)

![1630458889067](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630458889067.png)



## 5 R Squared

![1630459553437](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630459553437.png)

![1630459575078](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630459575078.png)

![1630460109035](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630460109035.png)

![1630460143933](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630460143933.png)

![1630460193797](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630460193797.png)



![1630460211212](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630460211212.png)

![1630460244786](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630460244786.png)

不适合求，但适合评测

![1630473711649](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630473711649.png)

RMSE 大一些（平方操作）

RMSE小-->更好

## 6 最好的衡量线性回归法的指标

![1630473843621](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630473843621.png)

![1630473885283](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630473885283.png)

![1630474003849](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630474003849.png)

![1630474068198](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630474068198.png)

![1630474164397](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630474164397.png)



## 7 多元线性回归和正规方程解

![1630498951040](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630498951040.png)

![1630498983704](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630498983704.png)

虚构第0个特征

![1630499507111](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630499507111.png)

![1630499562401](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630499562401.png)

![1630500543728](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630500543728.png)

![1630500592776](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630500592776.png)

![1630500687309](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630500687309.png)





## 8 实现多元线性回归

![1630500801675](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630500801675.png)



## 9 使用scilit-learn解决回归问题

## 10 线性回归的可解释性

# 六 梯度下降法(归一化)

## 1 什么是梯度下降法

![1630513796363](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630513796363.png)



## 2 线性回归中的梯度下降法

![1630513942383](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630513942383.png)

斜率

![1630513976542](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630513976542.png)

η：步长

![1630514038870](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630514038870.png)

一维：求导

多维：各个分量分别求导，最终得到的方向->梯度

![1630514225912](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630514225912.png)

![1630514238197](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630514238197.png)

![1630514352678](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630514352678.png)

![1630514369725](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630514369725.png)

二次函数有唯一极值点

![1630514407575](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630514407575.png)

![1630514462353](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630514462353.png)

![1630514496704](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630514496704.png)

起始点----->很重要

![1630514528446](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630514528446.png)



## 3 实现线性回归中的梯度下降法

![1630545665664](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630545665664.png)

导数：数字 -> 向量

梯度是下降最快的方向

![1630545757908](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630545757908.png)

![1630545790155](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630545790155.png)



![1630545871931](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630545871931.png)

要与样本数量m无关

预测值和真实值的MSE

![1630546078789](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630546078789.png)

与求导的2约掉





## 4 实现线性回归中的梯度下降法

## 5 梯度下降法的向量化

![1630559089568](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630559089568.png)

![1630559171659](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630559171659.png)

![1630559383099](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630559383099.png)



![1630559440360](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630559440360.png)

![1630560069449](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630560069449.png)



## 6 随机梯度下降法

![1630560596465](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630560596465.png)

![1630560983471](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630560983471.png)

去掉求和、`m`，已经不是梯度了

针对一个样本，随机取出一个`i`

用精度换取时间

避免错过最佳值，让`η`递减

`b`缓解初始时候`η`下降太快

![1630561524119](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630561524119.png)



`a`和`b`是随机梯度下降法的两个超参数

![1630561605489](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630561605489.png)



## 7 scikit-learn中的梯度下降法

## 8 有关梯度下降法的深入讨论

![1630565661941](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630565661941.png)

复杂度高，仅用于调试，高维：以theta0为例都很麻烦，其他theta不变，theta0加减很小的值

![1630566058007](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630566058007.png)

![1630566075892](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630566075892.png)

依次对每一个维度都是如此



## 9 有关梯度下降法的更多讨论

![1630566443100](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630566443100.png)

多引入一个超参数-->混合的方法

![1630566577245](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630566577245.png)

![1630566640702](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630566640702.png)

![1630566654319](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630566654319.png)



# 七 PCA(主成分分析法)

## 1 什么是PCA

![1630570290571](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630570290571.png)

![1630570326150](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630570326150.png)

![1630570497952](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630570497952.png)

右侧好一点：分散

![1630570525249](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630570525249.png)

斜线更好一些

![1630570570072](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630570570072.png)



![1630571619503](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630571619503.png)

![1630571651525](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630571651525.png)

![1630571671100](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630571671100.png)

![1630571700093](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630571700093.png)



两个X都是向量（可能都是多维）

![1646569447028](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646569447028.png)

![1630572043059](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630572043059.png)

![1630572125846](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630572125846.png)

![1646569506935](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646569506935.png)



![1646569530638](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646569530638.png)

![1646569556862](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646569556862.png)

![1646569577705](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646569577705.png)

![1646569596614](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646569596614.png)

## 2 求数据的主成分PCA

![1646569803883](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646569803883.png)

![1646570772032](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646570772032.png)

![1646570795251](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646570795251.png)

![1646570846436](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646570846436.png)

![1646570877139](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646570877139.png)

![1646570898339](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646570898339.png)

## 3 求数据的主成分



## 4 高维数据映射为低维数据

![1647131285429](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647131285429.png)

![1647131329820](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647131329820.png)

![1647131522949](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647131522949.png)

![1647131554204](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647131554204.png)

找到要映射的轴

## 5 高维数据映射为低维数据

![1647132425177](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647132425177.png)

高维向低位映射（已经不是原来的X了）

![1647132546893](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647132546893.png)

self.n_components 不是用户传来的数据，而是通过用户传来的数据计算的结果，用户可以去查询。

## 6 scikit-learn中的PCA

## 7 试手MNIST数据集

## 8 使用PCA对数据进行降噪

## 9 人脸识别与特征脸

![1647478491263](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647478491263.png)

特征脸

![1630426370918](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630426370918.png)

![1630426510022](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630426510022.png)

![1630426770618](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630426770618.png)

![1630427472218](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630427472218.png)

![1630427724135](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1630427724135.png)

# 八 多项式回归与模型泛化

## 1 什么是多项式回归(升维度)

![1647479292657](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647479292657.png)



## 2 scikit-learn中的多项式回归

![1647479950372](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647479950372.png)



## 3 过拟合与欠拟合

## 4 为什么要训练数据集与测试数据集

![1647481968356](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647481968356.png)

![1647482000312](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647482000312.png)

![1647482021184](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647482021184.png)



## 5 学习曲线

![1647482265386](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647482265386.png)

![1647482672879](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647482672879.png)

![1647482699232](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647482699232.png)



## 6 验证数据集与较叉验证

![1647563635057](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647563635057.png)

![1647563707702](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647563707702.png)

![1647563789179](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647563789179.png)

![1647565210251](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647565210251.png)

![1647565255729](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647565255729.png)

## 7 偏差方差平衡

![1647565291181](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647565291181.png)

![1647565360530](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647565360530.png)

![1647565386393](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647565386393.png)

![1647565408119](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647565408119.png)

![1647565447428](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647565447428.png)

![1647565462097](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647565462097.png)

![1647565537517](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647565537517.png)

![1647565581321](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647565581321.png)



![1647565735440](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647565735440.png)

## 8 模型泛化与岭回归

![1647565750315](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647565750315.png)

![1647565844028](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647565844028.png)

theta0只决定截距

## 9 LASSO

![1647566508160](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647566508160.png)

![1647566537489](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647566537489.png)

Lasso比Ridge阿尔法大一点

![1647566774304](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647566774304.png)

![1647566800843](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647566800843.png)

![1647566889355](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647566889355.png)

![1647567152949](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647567152949.png)



## 10 L1, L2弹性网络

![1647567243461](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647567243461.png)

![1647567295752](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647567295752.png)

![1647567379066](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647567379066.png)

![1647567394714](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647567394714.png)

![1647567437954](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647567437954.png)

theta的个数尽可能少-->穷举组合

![1647567612678](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647567612678.png)

# 九 逻辑回归

## 1 什么是逻辑回归

![1647567899151](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647567899151.png)

![1647567956567](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647567956567.png)

![1647568171283](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647568171283.png)

![1647568442515](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647568442515.png)

![1647568754563](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647568754563.png)

![1647568808447](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647568808447.png)



## 2 逻辑回归的损失函数

![1647569160994](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647569160994.png)

![1647569342514](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647569342514.png)

![1647569382789](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647569382789.png)

![1647569469138](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647569469138.png)

![1647569520408](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647569520408.png)



## 3 逻辑回归损失函数的梯度

![1647569612641](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647569612641.png)

![1647569715462](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647569715462.png)

![1647569774541](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647569774541.png)

![1647572247578](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647572247578.png)

![1647572335392](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647572335392.png)

![1647572488537](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647572488537.png)

![1647572552795](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647572552795.png)

![1647572602285](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647572602285.png)

![1647572986672](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647572986672.png)

![1647573074835](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647573074835.png)

![1647573197493](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647573197493.png)

![1647573286988](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647573286988.png)

## 4 实现逻辑回归算法

把线性回归代码改一改就好了

## 5 决策边界

![1647590713006](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647590713006.png)

![1647590742218](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647590742218.png)

![1647590972395](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647590972395.png)

![1647592286740](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647592286740.png)



## 6 在逻辑回归中使用多项式特征

![1647594701779](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647594701779.png)



## 7 scikt-learn中的逻辑回归

![1647596581827](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647596581827.png)

## 8 OvR与OvO

![1647597770224](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647597770224.png)

![1647597831582](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647597831582.png)

![1647597902729](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647597902729.png)

# 十 分类评价

## 1 准确度的陷阱和混淆矩阵

癌症本身1%，训练不训练盲猜也是1%。

对极度有偏数据不好

## 2 准确率和召回率

![1647996286766](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647996286766.png)

预测癌症的成功率，100次预测，40次是对的。

![1647996384959](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647996384959.png)

100个患者能找出80个

![1647996667319](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647996667319.png)

![1647996809287](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647996809287.png)

## 

![1647997435280](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647997435280.png)

![1647997464267](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647997464267.png)

![1647997577805](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647997577805.png)

## 3 现实混淆矩阵

## 4 F1 Score

![1647997671489](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647997671489.png)

算数平均值->调和平均值（只有都大，才会大）

![1647997719611](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647997719611.png)

![1647997775957](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647997775957.png)



## 5 准确率和召回率的平衡

![1647998110056](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647998110056.png)

![1647998164102](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647998164102.png)

![1647998334830](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647998334830.png)

## 6 准确率召回率曲线

![1647999446975](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647999446975.png)

包围面积大，好。

对有偏数据敏感

## 7 ROC曲线

![1647999498777](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647999498777.png)

![1647999508446](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647999508446.png)

![1647999561260](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647999561260.png)

![1647999657415](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647999657415.png)

![1648000071394](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1648000071394.png)

对有偏数据不敏感

## 8 多分类问题中的混淆矩阵



# 十一 支撑向量机SVM (标准化)

# (泛化考虑到算法中)

## 1 什么是SVM

![1646114088639](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646114088639.png)

逻辑回归通过概率解决不适定问题

![1646114161922](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646114161922.png)

泛化能力可能较差，因为离直线近。

![1646114205033](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646114205033.png)

![1646114372558](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646114372558.png)

margin = 2d

![1646114409489](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646114409489.png)



## 2 SVM背后的最优化问题

![1646114679048](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646114679048.png)

![1646114853266](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646114853266.png)

![1646114955386](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646114955386.png)

![1646115008370](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646115008370.png)

![1646115028781](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646115028781.png)

![1646115159897](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646115159897.png)

s.t. = such that

![1646115235818](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646115235818.png)

## 3 Soft Margin SVM

![1646115296695](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646115296695.png)

正则化并不只是 L1 L2范式

![1646115416961](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646115416961.png)

soft 要有容错能力，因为这个已经线性不可分了

![1646115610810](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646115610810.png)

两部分比例不一定一样

![1646115760681](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646115760681.png)

L1 ：绝对值求和

L2：平方和

```python
svc = LinearSVC(C=1e9) #越大 就hard margin svm  容错空间越小
```



## 4 Scikit-learn中的SVM

## 5 SVM中使用多项式特征和核函数

## 6 什么是核函数

![1646125149844](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646125149844.png)

![1646125296739](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646125296739.png)

添加特征-> 加一撇         kernel trick  节省存储空间

核函数不是SVM特有的

![1646125319128](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646125319128.png)

![1646125692698](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646125692698.png)

![1646126556166](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646126556166.png)

![1646126618079](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646126618079.png)

## 7 RBF核函数

![1646126728049](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646126728049.png)

![1646126821709](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646126821709.png)

![1646129744297](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646129744297.png)

![1646129761914](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646129761914.png)

![1646129840267](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646129840267.png)



![1646137216960](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646137216960.png)

![1646137336836](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646137336836.png)

无穷维的空间，m是有限个，只能这么多， 耗时多。

应用：自然语言处理！！！

## 8 RBF核函数中的gamma

![1646137654079](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646137654079.png)

gamma小，模型复杂度低，欠拟合。

gamma大，模型复杂度高，过拟合。

## 9 SVM思想解决回归问题

![1646139018923](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646139018923.png)

SVM解决回归：margin里面的点越多越好

SVM解决分类：margin里面的点越少越好

# 十二 决策树(非参数)

## 1 什么是决策树

![1631209189956](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1631209189956.png)

depth:3 三次判断

![1631209506471](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1631209506471.png)

![1631209569211](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1631209569211.png)



![1633672249539](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1633672249539.png)

![1633672406029](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1633672406029.png)

## 2 信息熵

![1631209621574](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1631209621574.png)

![1631209640224](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1631209640224.png)

![1631209697161](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1631209697161.png)

![1631209746210](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1631209746210.png)

![1631209789613](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1631209789613.png)

![1631210011316](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1631210011316.png)



## 3 基尼系数

![1646106877914](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646106877914.png)

基尼系数与信息熵性质是一样的。基尼系数越高，随机性越强，不确定性越强。

特例：二分类

![1646107005511](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646107005511.png)



## 4 信息熵和基尼系数的对比

![1646107299316](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646107299316.png)

## 5 CART与决策树中的超参数

![1646107423787](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646107423787.png)

![1646107451985](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646107451985.png)

![1646107569601](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646107569601.png)

所有的非参数学习算法都容易产生过拟合（KNN）

需要对参数进行平衡 eg: max_depth

![1646107972220](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646107972220.png)

![1647575824333](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647575824333.png)

## 6 决策树解决回归问题

![1631210269609](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1631210269609.png)

![1631210448980](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1631210448980.png)

![1631210469428](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1631210469428.png)

![1631210506558](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1631210506558.png)

## 7 决策树的局限性

![1631210578388](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1631210578388.png)

横平竖直

![1631210621624](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1631210621624.png)

![1631210629424](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1631210629424.png)

![1631210655061](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1631210655061.png)

![1631210667649](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1631210667649.png)

![1631210700283](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1631210700283.png)高度依赖于调参，更多用于随机森林。

# 十三 随机森林

## 1 什么是集成学习 (竞赛)

![1646109219470](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646109219470.png)

![1646109230495](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646109230495.png)

选择投票数目多的

![1646109299035](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646109299035.png)

![1646109348516](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646109348516.png)



## 2 Soft Voting Classifier

防止民主暴政

![1646110057662](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646110057662.png)

![1646110153061](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646110153061.png)

![1646110188889](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646110188889.png)

![1646110221993](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646110221993.png)

![1646110234487](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646110234487.png)

![1646110245634](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646110245634.png)

![1646110269698](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646110269698.png)

![1646110325216](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646110325216.png)

也是基于概率的

SVC(probability=True)

voting='soft'

## 3 Bagging-and-Pasting

大数定理

![1646110568032](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646110568032.png)

![1646110616557](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646110616557.png)



![1646110700501](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646110700501.png)

![1646110723377](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646110723377.png)

![1646110801181](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646110801181.png)

![1646110859098](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646110859098.png)



## 4 OOB-and-More-about-Bagging-Classifer

![1646111196710](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646111196710.png)

oob_score_  不是用户传进去的参数，而是类计算出的一个结果 后面有下划线

![1646111293672](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646111293672.png)

n_jobs 使用几个核

![1646111512568](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646111512568.png)

![1646111779748](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646111779748.png)

在行和列上都随机

## 5 Random-Forest-and-Extra-Trees

500颗树-->随机森林

![1646112126529](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646112126529.png)

随机森林集合了决策树核Bagging两种分类器

![1646112490300](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646112490300.png)

极其随机的森林 增加了偏差，遏制了方差

```python
# 集成学习解决回归问题 !!!
from sklearn.ensemble import BaggingRegressor
from sklearn.ensemble import RandomForestRegressor
from sklearn.ensemble import ExtraTreesRegressor
```

## 6 AdaBoost-and-Gradient-Boosting

没有预测好的数据加重权重

![1646112727428](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646112727428.png)

ensemble 集成算法的库

![1646112897398](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646112897398.png)

模型不断修正、补偿。

![#1646112979628](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646112979628.png)

```python
# Boosting 解决分类问题
from sklearn.ensemble import AdaBoostClassifier
from sklearn.ensemble import GradientBoostingClassifier
# Boosting 解决回归问题
from sklearn.ensemble import AdaBoostRegressor
from sklearn.ensemble import GradientBoostingRegressor
```

## 7 stacking 模型融合

![1646113113883](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646113113883.png)

也可以把概率-->分类

![1646113166567](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646113166567.png)

![1646113321425](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1646113321425.png)

每一层多少：超参数

多少层：超参数

-->深度学习

## 十四 学习scikit-learn文档

[用户指南-scikit-learn中文社区](https://scikit-learn.org.cn/lists/2.html)

```
https://scikit-learn.org.cn/lists/2.html
```

![1647618474826](C:\Users\小傲娇\AppData\Roaming\Typora\typora-user-images\1647618474826.png)

软件工程B ,语音信号数字处理

